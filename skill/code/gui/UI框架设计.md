#ui

# 思路

基于imgui，在了解了imgui的渲染特性以及设计过3次基础UI类加上了解了虚幻引擎的Slate结构后。对UI架构进行一个总结。

首先是UI基类，最新版的UI基类类似一个TreeNode结构。定义了树结构的通用接口。例如存储下一级节点，父节点等。结合imgui的ChildWindow可以自动计算尺寸等新功能，存储尺寸，透明度，id，padding等常规属性。但是没有考虑动画系统，还有布局槽系统

应该封装一个槽基类，其包含持有其的Widget和所要容纳的Widget。再为每一种容器类扩展一个子类，包含容器布局相关设置的必要信息。

- 水平框槽，记录偏移量，垂直方向的对齐方式(顶部，局中，底部，拉伸)，水平方向的对齐方式(如果水平框自行计算尺寸，则该配置项应无效，没有合适的办法能计算。但如果水平框有具体尺寸，不是依赖内部结构自动计算尺寸的，也应生效，让容纳的Widget根据自身尺寸，结合偏移量和对齐方式以及当前区域起始点计算新的起始点)，这样就可以用水平框实现左对齐两个小组件，右对齐两个小组件。并自适应父类面板布局了
- 垂直框槽，和水平类似
- 网格框槽，这一项算是水平加垂直的一种组合，但需要处理的逻辑更复杂一些。首先要定义是否自动计算一行所能容纳的组件数。如果不自动计算，则需要一个每行展示的组件数。其次要给定padding
- 覆层槽，这个对齐方式就有16种了。即水平方向4种和垂直方向4种的组合。配置padding
- 边界槽，继承覆层吧。这里和UE就不一样了。ue的border只能容纳一个子。这里定义边界是为了在覆层基础上追加一个背景框
- 为什么删除了？因为背景框行为不应在槽内封装，而是widget内封装
- 画布槽，这一个就很灵活了。不考虑ue那个复杂的锚点，这个和覆层不一样的地方就在于。这里除了包含容器锚点，还要包含自身锚点。举个例子，如果是在容器的水平垂直皆局中位置，容器锚点为0.5，0.5。但是如果自身锚点为0,0。则并不是组件在画布完全局中的位置。而是组件的左上角在画布局中位置。另外一个和覆层不同的是，覆层中只能有padding和锚点，没有尺寸的概念，即组件是自动计算尺寸的。但是画布中可以指定具体尺寸。

其次是组件类，应该

```plantuml
abstract class SWidget {

}

class FSlotBase {
  -owner_ : const FChildren* 
  -widget_ : shared_ptr<SWidget>
}

class FChildren {

}

class SLeafWidget {

}

class SPanel {

}

class TSlotBase<T> {

}



SWidget <|-- SPanel
SWidget <|-- SLeafWidget

FSlotBase <|-- TSlotBase
```

